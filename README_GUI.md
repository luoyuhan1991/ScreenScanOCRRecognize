# 屏幕扫描OCR识别系统 - GUI使用指南

## 📋 功能介绍

本程序提供图形用户界面（GUI），方便用户配置参数、监控状态和查看日志。

## 🚀 快速开始

### 方式一：直接运行（推荐）

1. **确保已安装Python 3.8+**
   ```bash
   python --version
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **运行GUI程序**
   ```bash
   python gui.py
   ```

### 方式二：使用打包的EXE（需要Python环境）

1. **打包程序**
   ```bash
   pip install pyinstaller
   pyinstaller build.spec
   ```

2. **运行打包后的程序**
   - 进入 `dist/ScreenScanOCR` 目录
   - 双击 `ScreenScanOCR.exe`

## 📖 使用说明

### 主界面说明

#### 1. 状态栏
- **状态**：显示当前运行状态（已停止/运行中）
- **扫描次数**：显示已完成的扫描次数
- **最后扫描**：显示最后一次扫描的时间

#### 2. 扫描配置
- **启用ROI区域选择**：勾选后，开始扫描时会弹出ROI选择窗口
- **启用GPU加速**：是否使用GPU加速OCR识别
- **扫描间隔**：设置两次扫描之间的间隔时间（1-60秒）

#### 3. OCR配置
- **OCR引擎**：选择PaddleOCR或EasyOCR
- **最小置信度**：设置OCR识别的最小置信度阈值（0.0-1.0）
- **启用图像预处理**：是否启用图像预处理
- **启用CLAHE增强**：是否启用CLAHE对比度增强
- **启用图像锐化**：是否启用图像锐化
- **快速模式**：跳过部分预处理以提升速度

#### 4. 文字匹配
- **启用文字匹配**：是否启用关键词匹配功能
- **关键词文件**：选择关键词文件路径（点击"浏览"按钮选择）
- **显示时长**：匹配成功后的显示时长（1-10秒）
- **显示位置**：选择显示位置（居中/顶部/底部）

#### 5. 运行日志
- 实时显示程序运行日志
- 支持不同级别的日志颜色显示
- 自动滚动到最新日志

#### 6. 功能按钮
- **▶ 开始扫描**：开始OCR扫描
- **⏹ 停止扫描**：停止当前扫描
- **⚙ 重置配置**：重置所有配置为默认值
- **📝 编辑配置**：打开配置文件编辑器

### 配置文件编辑器

点击"📝 编辑配置"按钮可以打开配置文件编辑器，支持：

- **语法高亮**：YAML语法高亮显示
- **格式验证**：保存时自动验证YAML格式
- **快捷键**：
  - `Ctrl+S`：保存配置
  - `Esc`：关闭编辑器
- **重置功能**：可以重置为原始内容

### 使用流程

1. **配置参数**
   - 根据需要调整扫描配置、OCR配置和文字匹配配置
   - 配置会自动保存到 `config.yaml`

2. **开始扫描**
   - 点击"▶ 开始扫描"按钮
   - 如果启用了ROI，会弹出ROI选择窗口
   - 程序开始按设定的间隔进行扫描

3. **查看结果**
   - 扫描结果保存在 `output` 目录
   - 日志区域显示实时运行状态
   - 如果匹配到关键词，会在屏幕上显示浮动提示

4. **停止扫描**
   - 点击"⏹ 停止扫描"按钮
   - 程序会安全停止当前扫描

## ⚙️ 配置说明

### 配置文件位置

- **业务配置**：`config.yaml`（通过GUI修改或直接编辑）
- **GUI状态**：`gui_state.json`（自动生成，保存窗口状态）

### 配置优先级

1. GUI设置（实时保存到config.yaml）
2. config.yaml文件配置
3. 默认配置（硬编码）

### 重要配置项

#### 扫描配置
- `scan.interval_seconds`：扫描间隔（秒）
- `scan.roi_padding`：ROI边距（像素）
- `scan.enable_roi`：是否启用ROI（GUI新增）

#### OCR配置
- `ocr.default_engine`：默认OCR引擎（paddle/easy）
- `ocr.min_confidence`：最小置信度
- `ocr.use_preprocessing`：是否使用预处理

#### GPU配置
- `gpu.force_gpu`：强制使用GPU
- `gpu.force_cpu`：强制使用CPU
- `gpu.auto_detect`：自动检测GPU

## 🐛 常见问题

### 1. GUI无法启动
- 检查Python版本（需要3.8+）
- 检查是否安装了tkinter（通常Python自带）
- 检查依赖是否安装完整

### 2. OCR识别不准确
- 调整最小置信度阈值
- 启用图像预处理
- 尝试不同的OCR引擎

### 3. GPU加速不生效
- 检查是否安装了GPU版本的依赖
- 检查NVIDIA驱动和CUDA是否正确安装
- 参考 `docs/GPU_SETUP_GUIDE.md`

### 4. 配置文件编辑后无效
- 检查YAML格式是否正确
- 重启程序以重新加载配置
- 查看日志区域是否有错误提示

## 📝 注意事项

1. **首次运行**：程序会自动创建必要的目录和文件
2. **配置保存**：GUI中的配置修改会立即保存到config.yaml
3. **窗口状态**：窗口大小和位置会自动保存
4. **日志限制**：日志区域最多显示1000行，超出会自动清理
5. **线程安全**：所有GUI更新都在主线程中进行

## 🔄 更新日志

### v1.0（当前版本）
- ✅ 基础GUI界面
- ✅ 参数配置功能
- ✅ 开始/停止功能
- ✅ 日志显示功能
- ✅ 配置文件编辑器
- ✅ 窗口状态保存

## 📞 技术支持

- GitHub Issues：https://github.com/luoyuhan1991/ScreenScanOCRRecognize/issues
- 邮箱：luoyuhan1991@github.com

---

**文档版本**：v1.0  
**最后更新**：2025-12-29

